<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>测试 LocalStorage 设置存储</title>
</head>
<body>
    <h1>LocalStorage 设置存储测试</h1>

    <h2>当前存储的设置：</h2>
    <pre id="current-settings">加载中...</pre>

    <h2>测试保存：</h2>
    <button onclick="saveTestSettings()">保存测试设置</button>
    <button onclick="loadSettings()">重新加载设置</button>
    <button onclick="clearSettings()">清除设置</button>

    <script>
        const STORAGE_KEY = "claude-assistant-settings";

        function loadSettings() {
            const stored = localStorage.getItem(STORAGE_KEY);
            const elem = document.getElementById('current-settings');

            if (stored) {
                try {
                    const parsed = JSON.parse(stored);
                    elem.textContent = JSON.stringify(parsed, null, 2);
                } catch (e) {
                    elem.textContent = '解析错误: ' + e.message + '\n原始数据: ' + stored;
                }
            } else {
                elem.textContent = '(无存储数据)';
            }
        }

        function saveTestSettings() {
            const testSettings = {
                apiKey: "test-api-key-12345",
                baseURL: "http://test.example.com/api",
                model: "claude-sonnet-4-5-20250929",
                maxTokens: 4096,
                temperature: 0.7,
                systemPrompt: "Test system prompt"
            };

            localStorage.setItem(STORAGE_KEY, JSON.stringify(testSettings));
            alert('测试设置已保存！');
            loadSettings();
        }

        function clearSettings() {
            localStorage.removeItem(STORAGE_KEY);
            alert('设置已清除！');
            loadSettings();
        }

        // 页面加载时显示当前设置
        window.onload = loadSettings;
    </script>
</body>
</html>
